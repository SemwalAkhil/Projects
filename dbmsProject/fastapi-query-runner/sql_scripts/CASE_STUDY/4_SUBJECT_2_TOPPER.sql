-- SUBJECT 2 TOPPER (1,2,3 POSITIONS)
-- RULES:
-- MARKS > 60% IN EACH SUBJECT
-- IF TWO STUDENTS HAVE SAME MARKS, THEN COMPARE BY AGGREGATE OF ALL SUBJECTS, IF AGGREGATE SAME THEN SAME POSITION
SELECT NAME as "Name",MARKS2 as 'Subject 2', RANK() OVER (ORDER BY MARKS2 DESC,MARKS1+MARKS2+MARKS3+MARKS4 DESC) AS "Rank" FROM MARKS WHERE MARKS1 > (45 * 0.6) AND MARKS2 > (65 * 0.6) AND MARKS3 > (65 * 0.6) AND MARKS4 > (65 * 0.6) LIMIT 3 ;